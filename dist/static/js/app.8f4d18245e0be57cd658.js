webpackJsonp([6],{"8jr1":function(e,t){},"D/cR":function(e,t,n){"use strict";var o=n("//Fk"),a=n.n(o),r=n("mtWM"),s=n.n(r),c=n("zL8q"),u=(n.n(c),n("OMJi")),i=(n.n(u),null),l={},f=s.a.create({baseURL:Object({NODE_ENV:"production",BASE_URL:"",CLIENT_ID:"5516d3ea77f069029efb24cf050e806a",CLIENT_SECRET:"99ea78c04240652da9d27a06dffcfdfb",GRANT_TYPE:"authorization_code",REDIRECT_URI:"http://localhost:8083/403",TOKEN_URL:"http://localhost:8080/accessToken"}).BASEAPI,timeout:5e3});f.defaults.headers.head["Content-Type"]="application/json",f.defaults.headers.post["Content-Type"]="application/json",f.interceptors.request.use(function(e){return l[e.url]?(l[e.url]("操作取消"),l[e.url]=void 0):l[e.url]=void 0,i=c.Loading.service({fullscreen:!0,lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(255,255,255,.5)"}),console.log(e),console.log(e),e},function(e){console.log(e),a.a.reject(e)}),f.interceptors.response.use(function(e){return i&&i.close(),e.data},function(e){if(console.log("err"+e),e&&e.response){console.log(e.response.status);var t=e.response.status;switch(t){case 400:e.message="请求错误";break;case 401:e.message="未授权，请重新登录";break;case 403:e.message="拒绝访问";break;case 404:e.message="请求错误，未找到改资源";break;case 405:e.message="请求方法未允许";break;case 500:e.message="服务端出错";break;case 504:e.message="网络超时";break;default:e.message="连接错误"+t}}else e.message="网络出现错误，请稍后再试";return Object(c.Message)({message:e.message,type:"error",duration:5e3}),a.a.reject(e)}),t.a=f},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var r=n("VU/8")(null,a,!1,function(e){n("8jr1")},null,null).exports,s=n("/ocq");o.default.use(s.a);var c=[{path:"/",redirect:"/403"},{path:"/",component:function(e){return n.e(0).then(function(){var t=[n("MpTN")];e.apply(null,t)}.bind(this)).catch(n.oe)},meta:{},children:[{path:"/dashboard",component:function(e){return n.e(3).then(function(){var t=[n("s+3R")];e.apply(null,t)}.bind(this)).catch(n.oe)},meta:{}},{path:"/403",component:function(e){return n.e(2).then(function(){var t=[n("C/fd")];e.apply(null,t)}.bind(this)).catch(n.oe)},meta:{title:"403"}}]},{path:"/login",component:function(e){return n.e(1).then(function(){var t=[n("vdVF")];e.apply(null,t)}.bind(this)).catch(n.oe)}},{path:"/404",component:function(e){return n.e(4).then(function(){var t=[n("c5Mg")];e.apply(null,t)}.bind(this)).catch(n.oe)}},{path:"*",redirect:"/404"}],u=[{}],i=new s.a({routes:c}),l=n("NYxO"),f={state:{showFooter:!0,changableNum:0},actions:{hideFooter:function(e){e.commit("hide")},showFooter:function(e){e.commit("show")},getNewNum:function(e,t){e.commit("newNum",t)}},mutations:{show:function(e){e.showFooter=!0},hide:function(e){e.showFooter=!1},newNum:function(e,t){e.changableNum+=t}}},d=n("//Fk"),h=n.n(d),p=n("D/cR");console.log(Object({NODE_ENV:"production",BASE_URL:"",CLIENT_ID:"5516d3ea77f069029efb24cf050e806a",CLIENT_SECRET:"99ea78c04240652da9d27a06dffcfdfb",GRANT_TYPE:"authorization_code",REDIRECT_URI:"http://localhost:8083/403",TOKEN_URL:"http://localhost:8080/accessToken"}));var m={login:function(e,t){var n={username:e,pwd:t};return Object(p.a)({url:"/login/login",method:"post",data:n})},logout:function(){return Object(p.a)({url:"/login/logout",method:"post"})},getUserInfo:function(e){return Object(p.a)({url:"/user/info",method:"get",params:{token:e}})}},g=n("iF09"),E={state:{user:"",status:"",code:"",token:Object(g.b)(),name:"",roles:[]},mutations:{SET_CODE:function(e,t){e.code=t},SET_TOKEN:function(e,t){e.token=t},SET_STATUS:function(e,t){e.status=t},SET_NAME:function(e,t){e.name=t},SET_ROLES:function(e,t){e.roles=t}},actions:{LoginByUsername:function(e,t){var n=e.commit,o=t.username.trim();return new h.a(function(e,a){m.login(o,t.password).then(function(t){var o=t.data;n("SET_TOKEN",o.validate_token),Object(g.f)(o.validate_token),e()}).catch(function(e){a(e)})})},GetUserInfo:function(e){var t=e.commit,n=e.state;return new h.a(function(e,o){m.getUserInfo(n.token).then(function(n){n||o("Verification failed, please login again.");var a=n.data;a.roles&&a.roles.length>0?t("SET_ROLES",a.roles):o("getInfo: roles must be a non-null array!"),t("SET_NAME",a.name),e(n)}).catch(function(e){o(e)})})},LogOut:function(e){var t=e.commit,n=e.state;return new h.a(function(e,o){m.api.logout(n.token).then(function(){t("SET_TOKEN",""),t("SET_ROLES",[]),Object(g.e)(),e()}).catch(function(e){o(e)})})},FedLogOut:function(e){var t=e.commit;return new h.a(function(e){t("SET_TOKEN",""),Object(g.e)(),e()})},ChangeRoles:function(e,t){var n=e.commit,o=e.dispatch;return new h.a(function(e){n("SET_TOKEN",t),Object(g.f)(t),getUserInfo(t).then(function(t){var a=t.data;n("SET_ROLES",a.roles),n("SET_NAME",a.name),o("GenerateRoutes",a),e()})})}}},b={state:{routers:c,addRouters:[]},mutations:{SET_ROUTES:function(e,t){e.addRouters=t,e.routers=c.concat(t)}},action:{GenerateRoutes:function(e,t){var n=e.commit;return new h.a(function(e){var o=t,a=void 0;a=o.include("admin")?u:Object(g.a)(u,o),n("SET_ROUTERS",a),e()})}}},T={showFooter:function(e){return e.test.showFooter},changableNum:function(e){return e.test.changableNum},token:function(e){return e.users.token},name:function(e){return e.users.name},status:function(e){return e.users.status},roles:function(e){return e.users.roles},routers:function(e){return e.permission.routers},addRouters:function(e){return e.permission.addRouters}},v=n("ZxDq"),R=n.n(v);o.default.use(l.a);var _=R()({SS:{module:E,storePath:"users"}}),O=new l.a.Store({modules:{test:f,users:E,permission:b},getters:T,plugins:[_]}),N=n("zL8q"),S=n.n(N),w=(n("tvR6"),n("j1ja"),n("Dd8w")),k=n.n(w),j=n("ZNlz"),L=n.n(j),I=["/login","/403"];i.beforeEach(function(e,t,n){if(L.a.start(),Object(g.b)())"login"===e.path?(n({path:"/"}),L.a.done()):0===O.getters.roles.length?O.dispatch("GetUserInfo").then(function(t){var o=t.data.roles;O.dispatch("GenerateRoutes",{roles:o}).then(function(){i.addRoutes(O.getters.addRouters),n(k()({},e,{replace:!0}))}).catch(function(e){O.dispatch("FedLogOut").then(function(){N.Message.error(e),n({path:"/"})})})}):Object(g.d)(O.getters.roles,e)?n():n({path:"/403",replace:!0,query:{noGoBack:!0}});else if(-1!==I.indexOf(e.path))n();else{window.location.href="http://localhost:8080/authorize?client_id=5516d3ea77f069029efb24cf050e806a&redirect_uri=http://localhost:8083/403&response_type=code&state=123456",L.a.done()}}),i.afterEach(function(){L.a.done()}),o.default.use(S.a,{size:"small"}),console.log(i),new o.default({router:i,store:O,render:function(e){return e(r)}}).$mount("#app")},iF09:function(e,t,n){"use strict";t.b=function(){return s.a.get(c)},t.f=function(e){return s.a.set(c,e)},t.e=function(){return s.a.remove(c)},t.d=u,t.c=function(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)","ig").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null},t.a=function e(t,n){var o=[];t.forEach(function(t){var r=a()({},t);u(n,r)&&(r.children&&(r.children=e(r.children,n)),o.push(r))});return o};var o=n("Dd8w"),a=n.n(o),r=n("lbHh"),s=n.n(r),c="Admin-Token";function u(e,t){return!t.meta||!t.meta.roles||e.some(function(e){return permissionRoles.indexOf(e)>=0})}},tvR6:function(e,t){}},["NHnr"]);